<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html lang="en">
<head>
	<title>Appointments</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css"
		  href="//cdn.jsdelivr.net/bootstrap/latest/css/bootstrap.css" />

	<link rel="stylesheet" type="text/css"
		  href="/static/css/busy.css" />
	<!-- jquery from a content distribution network; probably cached -->
	<script type="text/javascript"
			src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js">
	</script>
	<!-- Ideally the rest of our javascript dependencies would be
		 bundled and minified with 'browserify', but I've found that
		 it difficult to handle browserify dependencies for class
		 projects.  So, we'll pick up moment and a date range picker
		 from CDNs instead.
	-->
	<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
	<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
	<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />

</head>
<body>
	<div class="container">
		<h1>Busy times</h1>
		<!--
		  -- If there are any warnings or other messages from a prior action,
		  -- they appear above the rest of the content, just until the next
		  -- action.
		  -->
		{% with messages = get_flashed_messages() %}
			{% if messages %}
			<ul class=flashes>
				{% for message in messages %}
					<li>{{ message }}</li>
				{% endfor %}
			</ul>
			{% endif %}
		{% endwith %}

		<h2>Date range</h2>
		<form action="/setrange" method="post">
			{% if session.begin_date is defined %}
			<input type=date name="begin_date" id="begin_date" value={{ session.begin_date }} />
			<input type=time name="begin_time" id="begin_time" value={{ session.begin_time }} />
			<input type=date name="end_date" id="end_date" value={{ session.end_date }} />
			<input type=time name="end_time" id="end_time" value={{ session.end_time }} />
			{% else %}
			<input type=date name="begin_date" id="begin_date" value="2017-01-01" />
			<input type=time name="begin_time" id="begin_time" value="00:00" />
			<input type=date name="end_date" id="end_date" value="2017-01-01" />
			<input type=time name="end_time" id="end_time" value="00:00" />
			{% endif %}
			<br />
			<input type="submit" value="Choose" />
		</form>

		<!-- Show the calendar list (if we have it) -->

		{% if g.calendars is defined  %}
		<h3>Calander Select</h3>
		<form action="/getevents" method="post">
			<div class="row">
				{% for cal in g.calendars if cal.selected %}
				<div class="col-md-1"><input id="checkBox" name="{{cal.id}}" type="checkbox"></div>
				<div class="col-md-3">
					{{ cal.summary }}
				</div>
				{% if loop.index is divisibleby 3 %}
			</div> <div class="row">
				{% endif %}
				{% endfor %}
			</div>
			<br/><input type="submit" value="Get Events" />
		</form>
		{% endif %}

		{% if session.events|length > 0 %}
		<div id="events">
			<h3>{{ session.EventLength }} Events</h3>
			<div class="row">
				{% for event in session.events %}
				<div class="col-md-4">
					<p>
						Summary: {{ event.name }}
						<br />
						Start: {{ event.start | fmtdate }} {{ event.start | fmttime }}
						<br />
						End: {{ event.end | fmtdate }} {{ event.end | fmttime }}
					</p>
				</div>
				{% if loop.index is divisibleby 3 %}
			</div> <div class="row">
				{% endif %}
				{% endfor %}
			</div>
		</div>
		{% endif %}

		{% if session.freebusy|length > 0 %}
		<h3>Time Blocks</h3>
			{% for block in session.freebusy %}
			<h4>{{ block.Day }}</h4>
				<div class="row">
					{% for FreeBusy in block.FreeBusy %}
						<div class="col-xs-2 col-md-1">
							<p>
								{{ FreeBusy.FB }}
								<br />
								{{ FreeBusy.S }}
								<br />
								{{ FreeBusy.E }}
							</p>
						</div>
						{% if loop.index is divisibleby 12 %}
						</div> <div class="row">
						{% endif %}
					{% endfor %}
				</div>
			{% endfor %}
		{% endif %}
	</div>  <!-- container (for bootstrap) -->
</body>
</html>